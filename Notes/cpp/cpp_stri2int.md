# C++ å­—ä¸²/å­—å…ƒè½‰æ•´æ•¸æ–¹æ³•æ•´ç†

> åœ¨è™•ç†å‹åˆ¥è½‰æ›æ™‚ï¼Œå¸¸è¦‹éœ€æ±‚æ˜¯å°‡ string/char â†’ intï¼Œå°¤å…¶è¦æ³¨æ„ æ­£è² è™Ÿ (sign) èˆ‡ éŒ¯èª¤è™•ç†ã€‚

## 1. atoi (C å‡½å¼)

```cpp
#include <cstdlib>

int val = atoi("123");   // 123
int neg = atoi("-45");   // -45
int bad = atoi("abc");   // 0
```

### ç‰¹é»ï¼š

- âœ… æ”¯æ´æ­£è² è™Ÿ ("-123" â†’ -123, "+99" â†’ 99)
- âŒ éæ•¸å­— â†’ å›å‚³ 0ï¼Œç„¡æ³•å€åˆ†éŒ¯èª¤
- âŒ æ²’æœ‰éŒ¯èª¤æª¢æŸ¥

> å±¬æ–¼ C æ¨™æº–å‡½å¼ï¼Œåœ¨ C++ ä¸­ä¸å»ºè­°ä¸»è¦ä½¿ç”¨ã€‚

## 2. stoi (C++11 ä¹‹å¾Œ)

```cpp
#include <string>

int val = std::stoi("123");   // 123
int neg = std::stoi("-45");   // -45
int pos = std::stoi("+88");   // 88
```

### ç‰¹é»ï¼š

- âœ… æ”¯æ´æ­£è² è™Ÿ
- âœ… é‡åˆ°éŒ¯èª¤æœƒä¸Ÿä¾‹å¤–ï¼š
- `std::invalid_argument` â†’ å­—ä¸²ä¸æ˜¯æ•¸å­—
- `std::out_of_range` â†’ è¶…é int ç¯„åœ
- âœ… é‚„æœ‰ `stol` / `stoll` / `stoul` ç­‰å°æ‡‰ç‰ˆæœ¬

- âš ï¸ ä¾‹å¤–è™•ç†éœ€è¦ `try-catch`

    ```cpp
    try {
        int x = std::stoi("abc"); // throw std::invalid_argument
    } catch (std::invalid_argument& e) {
        std::cerr << "ä¸æ˜¯åˆæ³•æ•¸å­—ï¼\n";
    }
    ```

## 3. stringstream
```cpp
#include <sstream>
#include <string>

std::string s = "-123";
int num;
std::stringstream ss(s);
ss >> num;  // num = -123
```

### ç‰¹é»ï¼š

- âœ… æ”¯æ´æ­£è² è™Ÿ
- âœ… å¯é€é `ss.fail()` åˆ¤æ–·éŒ¯èª¤
- âŒ æ•ˆèƒ½æ¯” `stoi` æ…¢

## 4. from_chars (C++17)

```cpp
#include <charconv>
#include <string>

std::string s = "-456";
int num;
auto [ptr, ec] = std::from_chars(s.data(), s.data() + s.size(), num);

if (ec == std::errc()) {
    // âœ… è½‰æ›æˆåŠŸ
} else {
    // âŒ éŒ¯èª¤è™•ç†
}
```

### ç‰¹é»ï¼š

- âœ… æ”¯æ´æ­£è² è™Ÿ
- âœ… ç„¡ä¾‹å¤–ï¼ŒéŒ¯èª¤é€é ec åˆ¤æ–·
- âœ… æ•ˆèƒ½æœ€ä½³ (ä½éš API)
- âŒ å¯«æ³•è¼ƒè¤‡é›œ

## 5. å–®å€‹ char â†’ int

```cpp
char c = '7';
int num = c - '0';  // 7
```

### ç‰¹é»ï¼š

- âœ… å¿«é€Ÿã€ç°¡å–®
- âš ï¸ åƒ…é©ç”¨ '0' ~ '9'
- âŒ éæ•¸å­—å­—å…ƒ â†’ çµæœä¸æ­£ç¢º

---

## ğŸ“Š æ–¹æ³•æ¯”è¼ƒè¡¨

| æ–¹æ³•              | æ”¯æ´æ­£è² è™Ÿ   | éŒ¯èª¤è™•ç†       | æ•ˆèƒ½ | C++ ç‰ˆæœ¬ |
| --------------- | ------- | ---------- | -- | ------ |
| `atoi`          | âœ…       | âŒ ç„¡æ³•æª¢æŸ¥     | ä¸­ç­‰ | C æ¨™æº–   |
| `stoi`          | âœ…       | âœ… ä¾‹å¤–è™•ç†     | ä¸­ç­‰ | C++11+ |
| `stringstream`  | âœ…       | âœ… `fail()` | æ…¢  | C++98+ |
| `from_chars`    | âœ…       | âœ… `errc`   | æœ€å¿« | C++17+ |
| `c - '0'` (å–®å­—å…ƒ) | âŒ éœ€ç¢ºä¿ç¯„åœ | âŒ ç„¡æ³•æª¢æŸ¥     | æœ€å¿« | C æ¨™æº–   |

## âœ… å»ºè­°

- ä¸€èˆ¬æƒ…å¢ƒ â†’ `std::stoi` (å®‰å…¨ç°¡å–®)
- é«˜æ•ˆèƒ½éœ€æ±‚ â†’ `std::from_chars` (C++17+)
- å–®å­—å…ƒè½‰æ•¸å­— â†’ `c - '0'`
- èˆŠ C ç¨‹å¼ç¢¼ â†’ `atoi` (å»ºè­°é¿å…æ–°ç¨‹å¼ä½¿ç”¨)

## ğŸ“Š C++ å­—ä¸²è½‰æ•´æ•¸ï¼šæ•¸å€¼ç¯„åœèˆ‡å»ºè­°æ–¹æ³•

| æ•¸å€¼ç¯„åœ     | å»ºè­°å‹åˆ¥      | å»ºè­°è½‰æ›æ–¹æ³•  | éŒ¯èª¤è™•ç†   |
| ------------------------------------------------------------------------------- | -------------------- | -------------------------------------------------------- | ----------------------------------------------------------------------------------- |
| `[-2,147,483,648 ~ 2,147,483,647]` <br>(`int` ç¯„åœ)      | `int`                | `std::stoi` <br> `std::from_chars<int>`                  | `stoi` æœƒä¸Ÿ `std::out_of_range` <br> `from_chars` å›å‚³ `std::errc::result_out_of_range` |
| `[-9,223,372,036,854,775,808 ~ 9,223,372,036,854,775,807]` <br>(`long long` ç¯„åœ) | `long long`          | `std::stoll` <br> `std::from_chars<long long>`           | åŒä¸Šï¼Œè¶…å‡ºç¯„åœæœƒä¸Ÿä¾‹å¤–æˆ–å›å‚³éŒ¯èª¤ç¢¼                                                                   |
| `[0 ~ 18,446,744,073,709,551,615]` <br>(`unsigned long long` ç¯„åœ)                | `unsigned long long` | `std::stoull` <br> `std::from_chars<unsigned long long>` | è¶…å‡ºç¯„åœ â†’ `out_of_range` æˆ– `errc::result_out_of_range`                                 |
| å¤§æ–¼ `unsigned long long` (2^64-1)                                                | **å¤§æ•¸ (Big Integer)** | `boost::multiprecision::cpp_int` <br> GMP / MPIR         | å¯è™•ç†ä»»æ„å¤§å°æ•¸å­—                                                                           |

## ğŸ“Œ ä½¿ç”¨å»ºè­°

- æ—¥å¸¸æƒ…å¢ƒ (ä¸€èˆ¬æ•´æ•¸) â†’ ç”¨ `std::stoi`ï¼Œç°¡å–®ã€å®‰å…¨ã€‚
- é«˜æ•ˆèƒ½å ´æ™¯ â†’ ç”¨ `std::from_chars` (ç„¡ä¾‹å¤–ï¼Œé€Ÿåº¦å¿«)ã€‚
- æ•¸å­—å¯èƒ½è¶…é int â†’ å…ˆç”¨ `stoll`ï¼Œå†æ‰‹å‹•æª¢æŸ¥æ˜¯å¦è½åœ¨ `int` ç¯„åœã€‚
- æ¥µå¤§æ•¸å­— (è¶…é 64 ä½å…ƒ) â†’ ç”¨ `Boost.Multiprecision::cpp_int` æˆ– `GMP`ã€‚
